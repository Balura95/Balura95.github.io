<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kategorien & Playlist</title>
  <!-- Materialize CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- Google Fonts & Material Icons -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="categories.css">
</head>
<body>
  <div class="container" style="margin-top:20px;">
    <div class="card z-depth-3 center-align fade-in">
      <div class="card-content">
        <h4 class="card-title">Aus welcher Playlist sollen die Songs gespielt werden?</h4>
        <div class="input-field">
          <input id="playlist-url" type="text" value="">
          <label for="playlist-url">Selbsterstelle, öffentliche Playlist eintragen</label>
        </div>
        <div id="categories-container">
          <h5>Mit welchen Kategorien möchtest du spielen? (optional)</h5>
          <div class="input-field">
            <input class="category-input" type="text">
            <label>Kategorie eintragen</label>
          </div>
        </div>
        <div class="button-group">
          <button id="add-category" class="btn waves-effect waves-light blue">
            <i class="material-icons left">add</i> Kategorie hinzufügen
          </button>
          <button id="remove-category" class="btn waves-effect waves-light red">
            <i class="material-icons left">remove</i> Kategorie entfernen
          </button>
        </div>
        <!-- Weiter-Button leitet zu categorie2.html weiter -->
        <button id="next-button" class="btn-large waves-effect waves-light green" style="margin-top:20px;">
          Weiter
        </button>
      </div>
    </div>
    <!-- Neuer Button unterhalb der Card -->
    <button id="anleitung2-button" class="btn waves-effect waves-light orange" style="margin-top:20px;">
      Anleitung
    </button>
  </div>
  
  <!-- Overlay für Anleitung2 -->
  <div id="anleitung2-overlay">
    <div class="modal-content">
      <h4>Anleitung</h4>
      <p>
        Dieser Spielmodus lässt sich mit nur einem Handy und Internetverbindung spielen. <br />
        Trage einfach deine Spotifyplaylist (muss öffentlich sein), optional die Spielkategorien (Titel, Interpret, Jahr, hinzugefügt von, etc.) 
        und auf der nächsten Seite noch Mitspieler und benötigte Gewinnpunkte ein. <br />
        Die Spieler kommen dann der Reihe nach dran. Es wird ein zufälliger Song aus der Playlist abgespielt, und eine zufällige Kategorie ausgewählt, falls eingetragen. <br />
        Ob der Spieler die Kategorie richtig beantwortet hat, lässt sich durch ein Drücken auf "Songinfos feststellen". Falls ja, bestätigt ihr das mit einem Druck auf das grüne Häkchen,
        und der Spieler bekommt einen Punkt. Ansonsten presst ihr das rote X. Durch Drücken auf "Nächster Spieler" ist der nächste Spieler an der Reihe.<br />
        Sobald ein Spieler die nötigen Gewinnpunkte erreicht hat, ist das Spiel beendet.
      </p>
    </div>
    <div class="modal-footer">
      <button id="close-anleitung2" class="btn waves-effect waves-light red">Schließen</button>
    </div>
  </div>
  
  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Kategorie hinzufügen: Neues Input-Feld ohne placeholder (Labels übernehmen die Anzeige)
      document.getElementById('add-category').addEventListener('click', () => {
        const container = document.getElementById('categories-container');
        const div = document.createElement('div');
        div.className = 'input-field';
        div.innerHTML = '<input class="category-input" type="text"><label>Kategorie eintragen</label>';
        container.appendChild(div);
      });
      
      // Kategorie entfernen: Entfernt den letzten Eintrag, falls mehr als ein Feld vorhanden ist
      document.getElementById('remove-category').addEventListener('click', () => {
        const container = document.getElementById('categories-container');
        const fields = container.querySelectorAll('.input-field');
        if (fields.length > 1) {
          fields[fields.length - 1].remove();
        }
      });
      
      // Weiter-Button: Speichert Playlist-URL und Kategorien in localStorage und leitet zu categorie2.html weiter
      document.getElementById('next-button').addEventListener('click', () => {
        const playlistUrl = document.getElementById('playlist-url').value.trim();
        if (!playlistUrl) {
          M.toast({ html: "Bitte Playlist URL eingeben", classes: "rounded", displayLength: 2000 });
          return;
        }
        localStorage.setItem('mobilePlaylistUrl', playlistUrl);
        
        const catInputs = document.querySelectorAll('.category-input');
        let categories = [];
        catInputs.forEach(input => {
          const value = input.value.trim();
          if (value) categories.push(value);
        });
        // Kategorien sind optional – wenn leer, speichern wir einen leeren Array
        localStorage.setItem('mobileCategories', JSON.stringify(categories));
        
        window.location.href = 'categories2.html';
      });
      
      // Anleitung2 Overlay-Logik
      const anleitung2Btn = document.getElementById('anleitung2-button');
      const anleitung2Overlay = document.getElementById('anleitung2-overlay');
      const closeAnleitung2Btn = document.getElementById('close-anleitung2');
      
      anleitung2Btn.addEventListener('click', () => {
        anleitung2Overlay.style.display = 'flex';
      });
      
      closeAnleitung2Btn.addEventListener('click', () => {
        anleitung2Overlay.style.display = 'none';
      });
    });
  </script>
</body>
</html>
